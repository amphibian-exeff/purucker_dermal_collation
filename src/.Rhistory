r19al <- read.csv("data_in/rvm2019_alachlor.csv", skip = 1)
if(Sys.info()[4]=="LZ26EPAULUKO"){
amphibdir <- path.expand("C:/Users/epauluko/OneDrive - Environmental Protection Agency (EPA)/Profile/Documents/GitHub/amphib_dermal_collation/")
}
r19al <- read.csv("data_in/rvm2019_alachlor.csv", skip = 1)
r19al <- read.csv(amphibdir/"data_in/rvm2019_alachlor.csv", skip = 1)
r19al <- file.path(root_data_out,"data_in/rvm2019_alachlor.csv")
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
## rvm19
r19al$bw<-bw[match(r19al$ID, bw$Frog.ID),5]
r19at$bw<-bw[match(r19at$ID, bw$Frog.ID),5]
r19al<-na.omit(r19al)
bw    <- file.path(amphibdir, "data_in/bw_RVM.csv")
r19al<-read.csv(r19al)
r19at <-read.csv(r19at)
View(r19al)
View(r19at)
r19<-rbind(r19al,r19at)
View(r19)
r19<-ifelse(r19$atrazine=='Yes',r19$chemical == 'atrazine', r19$chemical == 'alachlor')
names(r19)
colnames(r19)
r19<-rbind(r19al,r19at)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
r19<-r19[,c(1,6,8)]
colnames(r19)
r19$chemical<-ifelse(r19[,3]=='Yes',r19$chemical == 'atrazine', r19$chemical == 'alachlor')
View(r19)
r19<-rbind(r19al,r19at)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
r19<-r19[,c(1,6,8)]
colnames(r19)
r19$chemical<-NA
r19[,8]<-ifelse(r19[,3]=='Yes',r19[,8]== 'atrazine', r19[,8] == 'alachlor')
View(r19)
ifelse(r19$atrazine =='Yes', r19$chemical== 'atrazine', r19$chemical == 'alachlor')
ifelse(r19$atrazine =="Yes", r19$chemical== 'atrazine', r19$chemical == 'alachlor')
strc(r19)
str(r19)
r19$chemical<-'NA'
str(r19)
ifelse(r19$atrazine =="Yes", r19$chemical== 'atrazine', r19$chemical == 'alachlor')
ifelse(r19[,3] =="Yes", r19[,8]== 'atrazine', r19[,8] == 'alachlor')
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runal<-read.csv(runat)
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
match
match
match
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runal<-read.csv(runat)
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runal<-read.csv(runal)
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
bw   <- file.path(amphibdir, "data_in/bw_RVM.csv")
lab  <- read.csv("data_out/amphib_dermal_collated.csv")
lab<-lab[,c(2:13)]
bw <-read.csv(bw)
bw <- file.path(amphibdir, "data_in/bw_RVM.csv")
bw <- read.csv(bw)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
r19<-r19[,c(1,6,8)]
colnames(r19)[1]<-'sample_id'
colnames(r19)[2]<-'tissue_conc_ugg'
colnames(r19)[3]<-'body_weight_g'
r19$application<-'soil'
r19$exp_duration<-8
r19$formulation<-0
r19$species<-'Southern Leopard Frog'
r19$soil_type<-'USLOAM'
r19$source<-'rvm2019'
r19$soil_conc_ugg<-NA
r19<-r19[c("app_rate_g_cm2" ,"application", "body_weight_g","chemical","exp_duration","formulation",
"sample_id", "soil_conc_ugg", "soil_type","source", "species","tissue_conc_ugg")]
##rvm unpub
runal$bw<-bw[match(runal$ID, bw$Frog.ID),5]
runat$bw<-bw[match(runat$ID, bw$Frog.ID),5]
runal<-na.omit(runal)
runat<-na.omit(runat)
View(r19)
View(run)
names(r19)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
View(r19)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
View(r19)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
View(r19)
colnames(r19)[1]<-'sample_id'
colnames(r19)[6]<-'tissue_conc_ugg'
colnames(r19)[10]<-'body_weight_g'
r19$application<-'soil'
r19$exp_duration<-8
r19$formulation<-0
r19$species<-'Southern Leopard Frog'
r19$soil_type<-'USLOAM'
r19$source<-'rvm2019'
r19$soil_conc_ugg<-NA
r19<-r19[c("app_rate_g_cm2" ,"application", "body_weight_g","chemical","exp_duration","formulation",
"sample_id", "soil_conc_ugg", "soil_type","source", "species","tissue_conc_ugg")]
View(r19)
write.csv(r19, 'data_in\rvm2019.csv')
rvm2019 <- file.path(amphibdir,"data_in/rvm2019.csv")
write.csv(rvm2019)
write.csv(r19, rvm2019)
View(run)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runal<-read.csv(runal)
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
##rvm unpub
run$bw<-bw[match(run$ID, bw$Frog.ID),5]
run<-na.omit(run)
run<-run[,c(1,5,6,8)]
colnames(run)[1]<-'sample_id'
colnames(run)[5]<-'tissue_conc_ugg'
colnames(run)[6]<-'soil_conc_ugg'
colnames(run)[10]<-'body_weight_g'
run$application<-'soil'
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runal<-read.csv(runal)
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
##rvm unpub
run$bw<-bw[match(run$ID, bw$Frog.ID),5]
run<-na.omit(run)
colnames(run)[1]<-'sample_id'
colnames(run)[5]<-'tissue_conc_ugg'
colnames(run)[6]<-'soil_conc_ugg'
colnames(run)[10]<-'body_weight_g'
run$application<-'soil'
run$exp_duration<-8
run$formulation<-0
run$species<-'Southern Leopard Frog'
run$soil_type<-'USLoam'
run$source<-'rvmunpub'
run<-run[c("app_rate_g_cm2" ,"application", "body_weight_g","chemical","exp_duration","formulation",
"sample_id", "soil_conc_ugg", "soil_type","source", "species","tissue_conc_ugg")]
rvm19 <-rbind(r19,run)
r19al <- file.path(amphibdir,"data_in/rvm2019_alachlor.csv")
r19al <-read.csv(r19al)
r19at <- file.path(amphibdir,"data_in/rvm2019_atrazine.csv")
r19at <-read.csv(r19at)
r19al$app_rate_g_cm2<-(34.8/1000000)
r19at$app_rate_g_cm2<-(23.6/1000000)
r19al$chemical<-'alachlor'
r19at$chemical<-'atrazine'
r19<-rbind(r19al,r19at)
runal <- file.path(amphibdir, "data_in/rvmunpub_alachlor.csv")
runal<-read.csv(runal)
runat <- file.path(amphibdir, "data_in/rvmunpub_atrazine.csv")
runat <- read.csv(runat)
runal$chemical<-'alachlor'
runat$chemical<-'atrazine'
runal$app_rate_g_cm2<-(34.8/1000000)
runat$app_rate_g_cm2<-(23.6/1000000)
run<-rbind(runal,runat)
bw <- file.path(amphibdir, "data_in/bw_RVM.csv")
bw <- read.csv(bw)
## rvm19
r19$bw<-bw[match(r19$ID, bw$Frog.ID),5]
r19<-na.omit(r19)
colnames(r19)[1]<-'sample_id'
colnames(r19)[6]<-'tissue_conc_ugg'
colnames(r19)[10]<-'body_weight_g'
r19$application<-'soil'
r19$exp_duration<-8
r19$formulation<-0
r19$species<-'Southern Leopard Frog'
r19$soil_type<-'USLOAM'
r19$source<-'rvm2019'
r19$soil_conc_ugg<-NA
r19<-r19[c("app_rate_g_cm2" ,"application", "body_weight_g","chemical","exp_duration","formulation",
"sample_id", "soil_conc_ugg", "soil_type","source", "species","tissue_conc_ugg")]
##rvm unpub
run$bw<-bw[match(run$ID, bw$Frog.ID),5]
run<-na.omit(run)
colnames(run)[1]<-'sample_id'
colnames(run)[5]<-'tissue_conc_ugg'
colnames(run)[6]<-'soil_conc_ugg'
colnames(run)[10]<-'body_weight_g'
run$application<-'soil'
run$exp_duration<-8
run$formulation<-0
run$species<-'Southern Leopard Frog'
run$soil_type<-'USLoam'
run$source<-'rvmunpub'
run<-run[c("app_rate_g_cm2" ,"application", "body_weight_g","chemical","exp_duration","formulation",
"sample_id", "soil_conc_ugg", "soil_type","source", "species","tissue_conc_ugg")]
rvm19 <-rbind(r19,run)
rvm2019 <- file.path(amphibdir,"data_in/rvm2019.csv")
write.csv(rvm19, rvm2019)
View(run)
### Table 1 Updates 7.12.21
library(dplyr)
library(tidyr)
amphibdir <- path.expand("C:/Users/epauluko/OneDrive - Environmental Protection Agency (EPA)/Profile/Documents/GitHub/amphib_dermal_collation/")
amphibdir_data_in <- paste(amphibdir,'data_in/',sep='')
amphibdir_data_out <- paste(amphibdir,'data_out/',sep='')
amphibdir_graphics <- paste(amphibdir,'graphics/',sep='')
amphibdir_src <- paste(amphibdir,'src/',sep='')
#RVM 2014
vm2015_file <- paste(amphibdir_data_in,"vm2014_data.csv", sep="")
file.exists(vm2015_file)
vm2015 <- read.table(vm2015_file, header = TRUE, sep = ",")
#atrazine
vm__2014_atrazine<-filter(vm2015, Chemical== 'Atrazine')
View(vm__2014_atrazine)
#atrazine
vm__2014_atrazine<-filter(vm2015, Chemical== 'Atrazine' & Application == 'Soil')
View(vm__2014_atrazine)
calc_atr<-vm__2014_atr %>% group_by(Species) %>% summarise(avg = mean(BCF), max = max(BCF), min = min(BCF))
calc_atr<-vm_2014_atr %>% group_by(Species) %>% summarise(avg = mean(BCF), max = max(BCF), min = min(BCF))
#atrazine
vm_2014_atr<-filter(vm2015, Chemical== 'Atrazine' & Application == 'Soil')
calc_atr<-vm_2014_atr %>% group_by(Species) %>% summarise(avg = mean(BCF), max = max(BCF), min = min(BCF))
View(calc_atr)
calc_atr
View(vm_2014_atr)
#atrazine - note no atrazine for ENM toad
vm_2014_atr<-filter(vm2015, Chemical== 'Atrazine' & Application == 'Soil')
calc_atr<-vm_2014_atr %>% group_by(Species) %>% summarise( min = min(BCF), max = max(BCF), avg = mean(BCF), )
calc_atr
View(vm2015)
#Imidacloprid
vm_2014_imid<-filter(vm2015, Chemical== 'Imidacloprid' & Application == 'Soil')
calc_2014<-vm2015 %>%
filter(Application == 'Soil') %>%
group_by(Chemical) %>%
group_by(Species) %>%
summarise( min = min(BCF), max = max(BCF), avg = mean(BCF), )
View(calc_2014)
View(vm2015)
names(vm2015)
View(calc_2014)
calc_2014<-vm2015 %>%
filter(Application == 'Soil') %>%
group_by(Chemical, Species) %>%
summarise(min = min(BCF), max = max(BCF), avg = mean(BCF), )
View(calc_2014)
View(calc_2014)
rvm2019 <- file.path(amphibdir,"data_in/rvm2019.csv")
write.csv(r19, rvm2019)
rvm2021 <- file.path(amphibdir,"data_in/rvm2020.csv")
write.csv(run, rvm2021)
rvm2021 <- file.path(amphibdir,"data_in/rvm2021.csv")
write.csv(run, rvm2021)
##################
# van meter 2014/15
##################
unique(vm2015$Chemical)
vm2015_chem_drop <- c("Atrazine","Deisopropyl Atrazine","Desethyl Atrazine","Fipronil","Fipronil-Sulfone","Triadimefon","Triadimenol")
chem_vector_drop <- which(vm2015$Chemical %in% vm2015_chem_drop)
vm2015_subset1 <- vm2015[-chem_vector_drop,]
vm2015_subset2 <- droplevels(vm2015_subset1)
dim(vm2015_subset2)
# drop unneeded columns for merging
all_cols <- colnames(vm2015_subset2)
drop_cols <- c("Instrument", "good", "logKow", "BCF", "initialweight",
"Solat20C_mgL", "Solat20C_gL", "molmass_gmol", "Density_gcm3","AppFactor", "SA_cm2", "VapPrs_mPa",
"Koc_gmL", "HalfLife_day", "HabFac")
vm2015_subset3 <- vm2015_subset2[,!(names(vm2015_subset2) %in% drop_cols)]
colnames(vm2015_subset3)
dim(vm2015_subset2)
colnames(vm2015_subset2)
colnames(vm2015_subset1)
all_cols
vm2015_subset3
View(vm2015_subset3)
View(vm2015_subset2)
View(vm2015_subset1)
# drop metabolites and parents that do not include metabolites
vm2015_chem_drop <- c("Atrazine","Deisopropyl Atrazine","Desethyl Atrazine","Fipronil","Fipronil-Sulfone","Triadimefon","Triadimenol")
chem_vector_drop <- which(vm2015$Chemical %in% vm2015_chem_drop)
vm2015_subset1 <- vm2015[-chem_vector_drop,]
vm2015_subset2 <- droplevels(vm2015_subset1)
View(r19al)
chem_vector_drop
colnames(chem_vector_drop)
View(vm2015_subset1)
View(vm2015_subset2)
View(vm2015)
