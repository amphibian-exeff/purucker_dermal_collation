---
title: "Compare data of amphibian dermal exposure with proposed models"
output: pdf_document
---

```{r eval=FALSE, echo=FALSE}
#ctrl-shift k to knit r markdown
#https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf
```

## Description
========================================================
Comparison of proposed amphibian dermal exposure model (DUST) from Draft 8/19/15 with collected dermal exposure data. Proposed DUST model has a function for exposure by direct spray and a function for exposure from foliage which is also referred to as indirect exposure. Collected dermal exposure data is from Van Meter et al. 2014 and Van Meter et al. 2015. Van Meter et al. 2014 and 2015 data includes exposure with 5 active ingredients (Imidacloprid, Pendimethalin, Atrazine, Fipronil, and Triadimefon) and 9 amphibian species in the terrestrial metamorph stage (american toad, barking treefrog, cricket frog, fowlers toad, gray treefrog, green treefrog, leopard frog, mole salamander, narrowmouth toad).

```{r eval=TRUE, echo=FALSE}
library(ggplot2)

# Import data from consolidated database
##################
#the data set
##################
# import data 
combined_data_filename <- paste(amphibdir_data_out,"amphib_dermal_collated.csv", sep="")
combined_data <- read.csv(combined_data_filename)
dim(combined_data)
colnames(combined_data)
#View(combined_data)
```

## tim model variants
```{r eval=TRUE, echo=FALSE}
colnames(combined_data)
n <- length(combined_data$tissue_conc_ugg)

# #bird model with perez body weight
# # we dont care about perez body weights because they are based on large pigeons
# sa_bird_perez <- 65.15 * (body_weight ^ 0.559)

# equation 1 default tim values
app_rate <- combined_data$app_rate_g_cm2
body_weight <- combined_data$body_weight_g
summary(body_weight)
conv_rate <- 1000000.0
dermal_af <- 1.0
hours_one <- 1.0
#bird model with tim body weight
sa_default_tim <- 10 * (body_weight ^ 0.667)
sa_tim_default_frac <- 0.5
tissue_conc <- combined_data$tissue_conc_ugg
summary(tissue_conc)
# calculate equation 1
combined_data$tim_direct_default <- (app_rate * conv_rate * sa_default_tim * sa_tim_default_frac * dermal_af)/body_weight
tim_direct_default <- combined_data$tim_direct_default
combined_data$tim_direct_default_ratios <- combined_data$tim_direct_default/tissue_conc
print(paste(min(combined_data$tim_direct_default_ratios), "-",   max(combined_data$tim_direct_default_ratios)))
hist(combined_data$tim_direct_default_ratios)
sum(tissue_conc > tim_direct_default)
sum(tissue_conc*10 > tim_direct_default)
plot(tissue_conc, combined_data$tim_direct_avian_1hr)
df.tim_default <- data.frame(x=tissue_conc, y=tim_direct_default)

#amphib model with hutchinson body weight
sa_amphib_hutchinson <- 1.131 * (body_weight ^ 0.579)
# sa_amphib_frac <- 2.0
combined_data$tim_direct_amphib <- (app_rate * conv_rate * sa_amphib_hutchinson * sa_tim_default_frac * dermal_af)/body_weight
combined_data$tim_direct_amphib_ratios <- combined_data$tim_direct_amphib/tissue_conc
min(combined_data$tim_direct_amphib_ratios)
max(combined_data$tim_direct_amphib_ratios)
sum(tissue_conc > combined_data$tim_direct_amphib_ratios)
sum(tissue_conc*10 > combined_data$tim_direct_amphib_ratios)
plot(tissue_conc, combined_data$tim_direct_amphib)
df.tim_amphib <- data.frame(x=tissue_conc, y=combined_data$tim_direct_amphib)

#create df of ratios
model_log_ratios <- as.vector(c(log10(combined_data$tim_direct_default_ratios), 
                        y=log10(combined_data$tim_direct_amphib_ratios)))
model_factor <- as.vector(c(rep('tim_default_direct',n),rep('tim_amphib_direct',n)))
df.ratios <- data.frame(x=model_factor, y=model_log_ratios)
```
## ggplot
```{r eval=TRUE, echo=FALSE}
plot1 <- ggplot(df.tim_amphib, aes(x=x, y=y)) + geom_point() + coord_fixed()
plot2 <- ggplot(df.ratios, aes(x=x, y=y)) + geom_point() + coord_fixed()
grid.arrange(plot1, plot2, ncol=2)

fill <- "#4271AE"
line <- "#1F3552"
ggplot(df.ratios, aes(x=x,y=y)) +
    geom_boxplot(fill = fill, colour = line) + # 
    scale_x_discrete(name = "Model") +
    scale_y_continuous(name = "log10 of Model-Observation Ratio") +
    theme_bw()
model_boxplot_filename <- paste(amphibdir_graphics,"model_boxplot.png",sep='')
ggsave(model_boxplot_filename, device="png", width=4, height=4)
```

surface area calculations
```{r eval=TRUE, echo=FALSE}
min_bw <- min(combined_data$body_weight_g, na.rm=T)
max_bw <- max(combined_data$body_weight_g, na.rm=T)
range_bw <- seq(min_bw, max_bw, by = 0.01)
default_sa <- 10*range_bw^0.667
hutchison_sa <- 1.131 * range_bw^0.579
max(default_sa/hutchison_sa)
sa_data <- data.frame(range_bw, default_sa, hutchison_sa)
ggplot(sa_data, aes(range_bw)) + 
  labs(x = "body weight (g)", y = "surface area (cm^2)",color = "Method") +
  geom_line(aes(y = default_sa, colour = "Default")) + 
  geom_line(aes(y = hutchison_sa, colour = "Hutchison")) +
  theme_bw() +
  theme(legend.position =c(0.2,0.8))
  
sa_comparison_filename <- paste(amphibdir_graphics,"sa_comparison.png",sep='')
ggsave(sa_comparison_filename, device="png", width=4, height=4)
```

